<p align="center"><a href="https://laravel.com" target="_blank"><img src="https://raw.githubusercontent.com/laravel/art/master/logo-lockup/5%20SVG/2%20CMYK/1%20Full%20Color/laravel-logolockup-cmyk-red.svg" width="400" alt="Laravel Logo"></a></p>

## О сервисе Image Service

`image_service` — это масштабируемый сервис, разработанный на Laravel, предназначенный для загрузки, хранения и обработки изображений. Он обеспечивает надёжный функционал для управления изображениями, используя хранилища S3 или совместимые с ним решения, такие как MinIO. Основные возможности:

- **Загрузка изображений**: Поддержка загрузки файлов с уникальными идентификаторами.
- **Обработка очередей**: Автоматическое повторение неудачных загрузок с настраиваемыми интервалами задержки.
- **Временное хранилище**: Сохранение изображений во временную директорию при сбоях, исключая потерю данных.
- **API-интерфейс**: Простые и удобные конечные точки для взаимодействия с сервисом.
- **Интеграция с MinIO/S3**: Надёжное и масштабируемое хранение объектов.

## Основные возможности

- **Кастомные идентификаторы**: Клиенты могут задавать собственные `id` для изображений для точного управления.
- **Механизм повторов**: Задания, которые не выполнились, автоматически добавляются в очередь с нарастающим временем задержки.
- **Логирование**: Полное логирование всех операций для диагностики и мониторинга.

## Установка и настройка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/your-repository/image_service.git
   cd image_service
   
2. Установите зависимости:
   ```bash
   composer install
   
3. Настройте файл .env
   
4. Выполните миграции:
   ```bash
    php artisan migrate
   
5. Запустите обработку очередей:
   ```bash
    php artisan queue:work

## Использование API

### Загрузка изображения

- **Эндпоинт**: `POST /api/upload-image/{id}`

- **Параметры**:
    - `id`: Идентификатор изображения (строка).
    - `image`: Файл изображения (multipart/form-data).

- **Пример запроса**:
  ```bash
  curl -X POST http://0.0.0.0/api/upload-image/custom-id \
       -F "image=@path/to/image.jpg"

- **Пример ответа**:
   ```json
  {
  "identifier": "custom-id",
  "url": "http://minio-bucket-url/path-to-image"
  }

### Очередь загрузок

При сбое загрузки изображение временно сохраняется локально и будет автоматически отправлено в S3 или MinIO позднее через очередь заданий.  
Система реализует механизм повторных попыток с использованием задержек. Задержки между попытками настроены следующим образом:

- 10 секунд
- 1 минута
- 10 минут
- 30 минут
- 2 часа
- 6 часов
- 24 часа

Этот механизм позволяет обеспечить надежную обработку загрузок даже при временных сбоях.
